# 라이브러리 버전 관리 및 오류 방지 가이드

## 개요

이 가이드는 WhatYourSub 프로젝트에서 사용하는 라이브러리의 버전을 효과적으로 관리하고 호환성 문제로 인한 오류를 방지하기 위한 지침을 제공합니다. 최근 date-fns 라이브러리 버전 호환성 문제로 인한 빌드 오류 경험을 바탕으로 작성되었습니다.

## 핵심 라이브러리 및 권장 버전

프로젝트에서 사용하는 주요 라이브러리와 안정적인 버전은 다음과 같습니다:

| 라이브러리 | 권장 버전 | 현재 버전 | 주의사항 |
|------------|------------|------------|----------|
| Next.js | 15.1.8 | 15.1.8 | 마이너 버전 업데이트는 테스트 후 적용 |
| React | 19.0.0 | 19.0.0 | 메이저 버전 변경 시 광범위한 테스트 필요 |
| date-fns | 3.3.1 | 3.3.1 | 4.x 버전은 호환성 문제 발생 |
| @supabase/supabase-js | 2.49.8 | 2.49.8 | API 변경이 잦으므로 버전 고정 권장 |
| react-hook-form | 7.56.4 | 7.56.4 | 폼 관련 중요 기능, 버전 고정 필수 |
| daisyui | 5.0.37 | 5.0.37 | UI 컴포넌트에 영향, 버전 고정 권장 |
| tailwindcss | 3.4.1 | 3.4.1 | 스타일링 핵심, 버전 고정 권장 |

## 버전 관리 지침

### 1. 정확한 버전 지정

중요 라이브러리는 `^` 또는 `~` 대신 정확한 버전을 지정하여 예기치 않은 업데이트를 방지합니다.

```json
// 권장하지 않음
"date-fns": "^4.1.0",

// 권장함
"date-fns": "3.3.1",
```

### 2. 버전 업데이트 프로세스

라이브러리 버전 업데이트 시 다음 절차를 따릅니다:

1. 개발 브랜치에서 먼저 업데이트 및 테스트
2. 변경 로그 확인 및 주요 변경사항 파악
3. 프로젝트의 관련 코드 리뷰
4. 단위 테스트 및 통합 테스트 실행
5. 개발 환경에서 완전한 테스트 후 병합

### 3. 종속성 잠금 관리

`package-lock.json` 파일을 버전 관리에 포함하여 모든 개발자가 동일한 종속성 버전을 사용하도록 합니다.

## 일반적인 문제 및 해결 방법

### 1. 빌드 캐시 문제

**증상**: 빌드 오류가 발생하며 캐시 관련 메시지가 표시됩니다.

**해결 방법**:
```bash
# Next.js 캐시 삭제
Remove-Item -Recurse -Force .next

# 개발 서버 재시작
npm run dev
```

### 2. 라이브러리 호환성 문제

**증상**: 특정 라이브러리 함수가 예상대로 동작하지 않거나 TypeError가 발생합니다.

**해결 방법**:
```bash
# 안정적인 이전 버전으로 다운그레이드
npm install [라이브러리명]@[안정버전]

# 예시: date-fns 다운그레이드
npm install date-fns@3.3.1
```

### 3. 종속성 충돌

**증상**: 여러 패키지의 종속성 요구사항이 충돌하는 경우

**해결 방법**:
```bash
# npm의 종속성 트리 확인
npm ls [패키지명]

# 종속성 강제 해결
npm install --force
```

## 디버깅 절차

1. 오류 메시지 캡처 및 정확한 문제 파악
2. 최근 변경된 라이브러리 확인
3. 관련 컴포넌트 및 기능 격리 테스트
4. 필요시 라이브러리 공식 이슈 트래커 확인
5. 임시 해결책 적용 후 근본 원인 해결

## 예방적 접근

1. 중요 업데이트 전 테스트 환경에서 먼저 검증
2. 정기적인 종속성 감사 실행: `npm audit`
3. 취약점 및 종속성 업데이트 자동화 고려
4. 주요 기능에 대한 단위 테스트 작성으로 회귀 문제 조기 발견

## 결론

라이브러리 버전 관리는 안정적인 프로젝트 유지를 위한 핵심 요소입니다. 이 가이드를 참조하여 일관된 방식으로 종속성을 관리하고 예기치 않은 문제를 방지하세요. 새로운 문제나 해결책이 발견되면 이 문서를 지속적으로 업데이트하여 팀 전체의 지식 자산으로 활용하시기 바랍니다. 